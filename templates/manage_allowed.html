{% extends 'base.html' %}

{% block title %}Allowed Domains - Squid Allow Manager{% endblock %}

{% block content %}
<div class="card">
    <h2>Allowed Domains</h2>
    {% set page = 'allowed' %}
    {% include '_actions_button.html' %}
    <form method="post" action="{{ url_for('manage_allowed') }}">
        <table>
            <tr>
                <th><input type="checkbox" id="selectAll"></th>
                <th>Domain</th>
                <th>Actions</th>
            </tr>
            {% for domain in domains %}
            <tr>
                <td><input type="checkbox" name="selected_domains" value="{{ domain }}"></td>
                <td>{{ domain }}</td>
                <td>
                    <button type="submit" name="action" value="remove:{{ domain }}" class="btn btn-danger">Remove</button>
                </td>
            </tr>
            {% endfor %}
        </table>
        <div class="actions">
            <input type="text" name="new_domain" placeholder="Add new domain">
            <button type="submit" name="action" value="add" class="btn btn-primary">Add</button>
        </div>
    </form>
</div>
<script>
document.getElementById('selectAll')?.addEventListener('change', function(e) {
    document.querySelectorAll('input[name="selected_domains"]').forEach(cb => cb.checked = e.target.checked);
});
</script>
{% endblock %}